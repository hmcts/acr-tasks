{
  "$schema": "http://schema.management.azure.com/schemas/2014-04-01-preview/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "subscription": {
      "type": "string"
    },
    "resourceGroup": {
      "type": "string"
    },
    "registry": {
      "type": "string"
    },
    "taskName": {
      "type": "string"
    },
    "location": {
      "type":"string",
      "defaultValue":"uksouth"
    },
    "teamName": {
      "type": "string"
    },
    "contextPath": {
      "type": "string"
    },
    "dockerFilePath": {
      "type": "string"
    },
    "imageName": {
      "type": "string"
    },
    "arguments": {
      "type": "string",
      "defaultValue": null
    }
  },
  "resources": [
    {
      "name": "[parameters('taskName')]",
      "type": "Microsoft.ContainerRegistry/registries/tasks",
      "apiVersion": "2018-09-01",
      "location": "[parameters('location')]",
      "tags": {},
      "properties": {
        "status": "Enabled",
        "platform": {
          "architecture": "amd64",
          "os": "Linux",
          "variant": "v8"
        },
        "agentConfiguration": {
          "cpu": 2
        },
        "timeout": 3600,
        "step": {
          "arguments": "[array(parameters('arguments'))]",
          "baseImageDependencies": null,
          "contextAccessToken": null,
          "contextPath": "[parameters('contextPath')]",
          "dockerFilePath": "[parameters('dockerFilePath')]",
          "imageNames": [
            "[parameters('imageName')]"
          ],
          "isPushEnabled": true,
          "noCache": false,
          "target": null,
          "type": "Docker"
        },
        "trigger": {
          "baseImageTrigger": {
            "baseImageTriggerType": "Runtime",
            "name": "defaultBaseimageTriggerName",
            "status": "Enabled"
          },
          "sourceTriggers": []
        },
        "credentials": null
      }
    }
  ],
  "variables": {}
}  
